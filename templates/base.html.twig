<!DOCTYPE html>
<html lang="{{ locale }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>{% block title %}MicroPosts{% endblock %}</title>
    {% block stylesheets %}
        {{ encore_entry_link_tags('app') }}
        {#<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />#}
    {% endblock %}
</head>
<body class="bg-light">

{%  include('./includes/nav.html.twig') %}

<main role="main" class="container">
    <div class="my-3 p-3 bg-white rounded box-shadow">
        {% block body %}
        {% endblock %}
    </div>
</main>
{% block javascripts %}
    {{ encore_entry_script_tags('app') }}

    {% if is_granted('ROLE_USER') %}
        <script>
            function fetchNotificationCount() {
                fetch(
                    '{{ path('notification_unread') }}',
                    {'credentials': 'include'}
                ).then((response)=> {
                    response.json()
                        .then((data)=> {
                            document.getElementById('js-notification-count').innerHTML = data.count;
                            setTimeout(fetchNotificationCount, 5000);
                        });
                }).catch((reason)=> {
                    console.warn(reason);
                });
            }

            fetchNotificationCount();
        </script>
    {% endif %}
{% endblock %}
</body>
</html>